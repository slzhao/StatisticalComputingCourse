---
title: "Multiple regression"
output:
  html_document:
    theme: cerulean
    toc: yes
    toc_depth: 3
    number_sections: false
    toc_float: 
       collapsed: true
    #code_folding: hide
---

```{=html}
<style>
h2 {
  background-color: #D4DAEC;
}
</style>
```

-   Motivation
-   Data visulization
-   Perform multiple linear regression analysis
-   Model interpretation
-   Model evaluation
-   Multiple logistic regression


## Introduction of the methods (recapture the course)

**Multiple linear regression** is an extension of simple linear regression used to predict an outcome variable (y) on the basis of multiple distinct predictor variables (x).




```{r,message=FALSE}

library(effects)

```


## Multiple linear regression

Short introduction about data and Motivations here.

```{r}

dataForAnalysis=read.csv("./data/fev.csv",header=TRUE,row.names=1)
dataForAnalysis$sex=factor(dataForAnalysis$sex)
dataForAnalysis$smoke =factor(dataForAnalysis$smoke)

```

### Data visulization


```{r}

summary(dataForAnalysis)
pairs(dataForAnalysis[,1:3])

boxplot(dataForAnalysis$fev~dataForAnalysis$sex)
boxplot(dataForAnalysis$fev~dataForAnalysis$smoke)


```




### Perform the multiple regression analysis

```{r}

modelResult <- glm(fev ~ age+height +sex +smoke   , data = dataForAnalysis, family = "binomial")


```

### Model Interpretation

1. Examine the F-statistic and the associated p-value, at the bottom of model summary.
2. Examine the coefficients table, which shows the estimate of regression beta coefficients and the associated t-statitic p-values

```{r}

summary(modelResult)
confint(modelResult)

plot(allEffects(modelResult))


```


### Model Evaluation


```{r}

op=par(mfrow=c(2,2),mar=c(4,4,2,2))
plot(modelResult)

par(op)

```



### Predict new data

```{r}

newData <- data.frame(age = c(9,10),height=c(60,70),sex=factor(c(1,2)),smoke=factor(c(1,2)))
result <-  predict(modelResult,newData)
print(result)


```


## Multiple logistic regression

Short introduction about data and Motivations here.

```{r}

dataForAnalysis=mtcars
dataForAnalysis$vs=factor(dataForAnalysis$vs)
```




### Perform the multiple regression analysis

```{r}

modelResult <- lm(am  ~ wt  + hp+vs , data = dataForAnalysis)

summary(modelResult)

#Odds ratio
exp(modelResult$coefficients)

```



### Model Interpretation

1. Examine the F-statistic and the associated p-value, at the bottom of model summary.
2. Examine the coefficients table, which shows the estimate of regression beta coefficients and the associated t-statitic p-values

```{r}

summary(modelResult)
confint(modelResult)

plot(allEffects(modelResult))


```



### Model evaluation


```{r}

op=par(mfrow=c(2,2),mar=c(4,4,2,2))
plot(modelResult)

par(op)

```





